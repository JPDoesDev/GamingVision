<Window x:Class="GamingVision.Windows.GroupEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:GamingVision.Converters"
        Title="Edit Overlay Group"
        Width="550"
        Height="1050"
        MinWidth="450"
        MinHeight="910"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        Background="{DynamicResource BackgroundBrush}"
        AutomationProperties.Name="Overlay Group Editor Window">
    <Window.Resources>
        <converters:ColorStringToBrushConverter x:Key="ColorStringToBrushConverter"/>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Group Name -->
        <GroupBox Header="Group Name" Grid.Row="0">
            <TextBox x:Name="NameTextBox"
                     Text="{Binding GroupName, UpdateSourceTrigger=PropertyChanged}"
                     MaxLength="50"/>
        </GroupBox>

        <!-- Color and Thickness -->
        <GroupBox Header="Appearance" Grid.Row="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="60"/>
                </Grid.ColumnDefinitions>

                <!-- Color - Red -->
                <TextBlock Text="Red:" VerticalAlignment="Center" Grid.Row="0"/>
                <Slider x:Name="RedSlider"
                        Grid.Row="0" Grid.Column="1"
                        Minimum="0" Maximum="255"
                        Value="{Binding Red}"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="0" Grid.Column="2"
                           Text="{Binding Red, StringFormat={}{0:0}}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Color - Green -->
                <TextBlock Text="Green:" VerticalAlignment="Center" Grid.Row="1"/>
                <Slider x:Name="GreenSlider"
                        Grid.Row="1" Grid.Column="1"
                        Minimum="0" Maximum="255"
                        Value="{Binding Green}"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="1" Grid.Column="2"
                           Text="{Binding Green, StringFormat={}{0:0}}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Color - Blue -->
                <TextBlock Text="Blue:" VerticalAlignment="Center" Grid.Row="2"/>
                <Slider x:Name="BlueSlider"
                        Grid.Row="2" Grid.Column="1"
                        Minimum="0" Maximum="255"
                        Value="{Binding Blue}"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="2" Grid.Column="2"
                           Text="{Binding Blue, StringFormat={}{0:0}}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Color Preview -->
                <TextBlock Text="Preview:" VerticalAlignment="Center" Grid.Row="3"/>
                <Rectangle x:Name="ColorPreview"
                           Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2"
                           Height="30"
                           Stroke="White" StrokeThickness="1"
                           Fill="{Binding Color, Converter={StaticResource ColorStringToBrushConverter}}"
                           Margin="0,5,0,5"
                           HorizontalAlignment="Stretch"/>

                <!-- Thickness -->
                <TextBlock Text="Thickness:" VerticalAlignment="Center" Grid.Row="4"/>
                <Slider x:Name="ThicknessSlider"
                        Grid.Row="4" Grid.Column="1"
                        Minimum="1" Maximum="10"
                        Value="{Binding Thickness}"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="4" Grid.Column="2"
                           Text="{Binding Thickness, StringFormat={}{0}px}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Confidence Threshold -->
                <TextBlock Text="Min Confidence:" VerticalAlignment="Center" Grid.Row="5"/>
                <Slider x:Name="ConfidenceSlider"
                        Grid.Row="5" Grid.Column="1"
                        Minimum="0.05" Maximum="1.0"
                        Value="{Binding ConfidenceThreshold}"
                        TickFrequency="0.05"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="5" Grid.Column="2"
                           Text="{Binding ConfidenceThreshold, StringFormat={}{0:P0}}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>
            </Grid>
        </GroupBox>

        <!-- Box Style and Label Display -->
        <GroupBox Header="Box Style" Grid.Row="2">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="Style:" VerticalAlignment="Center" Grid.Row="0"/>
                <ComboBox x:Name="StyleComboBox"
                          Grid.Row="0" Grid.Column="1"
                          ItemsSource="{Binding StyleOptions}"
                          SelectedItem="{Binding SelectedStyle}"
                          DisplayMemberPath="DisplayName"
                          Margin="0,0,0,10"/>

                <CheckBox x:Name="ShowLabelCheckBox"
                          Grid.Row="1" Grid.ColumnSpan="2"
                          Content="Show label text above box"
                          IsChecked="{Binding ShowLabel}"/>
            </Grid>
        </GroupBox>

        <!-- Preview -->
        <GroupBox Header="Preview" Grid.Row="3" Height="80">
            <Canvas x:Name="PreviewCanvas" Background="#FF1A1A1A"/>
        </GroupBox>

        <!-- Labels Selection -->
        <GroupBox Header="Labels in this Group" Grid.Row="4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Available Labels -->
                <DockPanel Grid.Column="0">
                    <TextBlock Text="Available:" DockPanel.Dock="Top" Margin="0,0,0,5"/>
                    <ListBox x:Name="AvailableLabelsListBox"
                             ItemsSource="{Binding AvailableLabels}"
                             SelectionMode="Extended"/>
                </DockPanel>

                <!-- Add/Remove Buttons -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10">
                    <Button Content="Add &gt;" Click="AddLabel_Click" MinWidth="60" Margin="0,5"/>
                    <Button Content="&lt; Remove" Click="RemoveLabel_Click" MinWidth="60" Margin="0,5"/>
                </StackPanel>

                <!-- Selected Labels -->
                <DockPanel Grid.Column="2">
                    <TextBlock Text="Selected:" DockPanel.Dock="Top" Margin="0,0,0,5"/>
                    <ListBox x:Name="SelectedLabelsListBox"
                             ItemsSource="{Binding SelectedLabels}"
                             SelectionMode="Extended"/>
                </DockPanel>
            </Grid>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="OK" Click="OK_Click" MinWidth="100" IsDefault="True"/>
            <Button Content="Cancel" Click="Cancel_Click" MinWidth="100" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>

<Window x:Class="GamingVision.Views.GameSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:GamingVision.Converters"
        mc:Ignorable="d"
        Title="Game Settings"
        SizeToContent="Height"
        Width="650"
        MinWidth="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        Background="{DynamicResource BackgroundBrush}"
        AutomationProperties.Name="Game Settings Window">

    <Window.Resources>
        <converters:ColorStringToBrushConverter x:Key="ColorStringToBrushConverter"/>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Game Selection -->
        <GroupBox Grid.Row="0" Header="Manage Games">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <ComboBox Grid.Column="0" ItemsSource="{Binding Games}"
                          SelectedItem="{Binding SelectedGame}"
                          DisplayMemberPath="DisplayName"
                          AutomationProperties.Name="Select Game to Configure"/>
                <Button Grid.Column="1" Content="Add" Margin="10,0,5,0"
                        Command="{Binding AddGameCommand}"
                        AutomationProperties.Name="Add New Game"/>
                <Button Grid.Column="2" Content="Delete"
                        Command="{Binding DeleteGameCommand}"
                        AutomationProperties.Name="Delete Selected Game"/>
            </Grid>
        </GroupBox>

        <!-- Settings TabControl -->
        <TabControl Grid.Row="1" Margin="0,10,0,0">
            <!-- Game Profile Tab -->
            <TabItem Header="Profile" AutomationProperties.Name="Game Profile Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Display Name:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="15,5"
                                 Text="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="Game Display Name"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Model File:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="15,5"
                                 Text="{Binding ModelFile, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="ONNX Model File Path"/>
                        <Button Grid.Row="1" Grid.Column="2" Content="Browse..."
                                Command="{Binding BrowseForModelCommand}"
                                AutomationProperties.Name="Browse for Model File"/>

                        <!-- Waypoint Tracker Configuration -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Waypoint Tracker:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding WaypointDisplay}" VerticalAlignment="Center" Margin="15,8"
                                   Foreground="{DynamicResource SecondaryTextBrush}" TextTrimming="CharacterEllipsis"
                                   AutomationProperties.Name="Waypoint Tracker Summary"/>
                        <Button Grid.Row="2" Grid.Column="2" Content="Configure..."
                                x:Name="ConfigureWaypointButton" Click="ConfigureWaypointButton_Click"
                                AutomationProperties.Name="Configure Waypoint Tracker"/>

                        <!-- Detection Label Configuration -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Primary Detection:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PrimaryLabelsDisplay}" VerticalAlignment="Center" Margin="15,8"
                                   Foreground="{DynamicResource SecondaryTextBrush}" TextTrimming="CharacterEllipsis"
                                   AutomationProperties.Name="Primary Labels Summary"/>
                        <Button Grid.Row="3" Grid.Column="2" Content="Configure..."
                                x:Name="ConfigurePrimaryButton" Click="ConfigurePrimaryButton_Click"
                                AutomationProperties.Name="Configure Primary Detection Labels"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Secondary Detection:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SecondaryLabelsDisplay}" VerticalAlignment="Center" Margin="15,8"
                                   Foreground="{DynamicResource SecondaryTextBrush}" TextTrimming="CharacterEllipsis"
                                   AutomationProperties.Name="Secondary Labels Summary"/>
                        <Button Grid.Row="4" Grid.Column="2" Content="Configure..."
                                x:Name="ConfigureSecondaryButton" Click="ConfigureSecondaryButton_Click"
                                AutomationProperties.Name="Configure Secondary Detection Labels"/>

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Tertiary Detection:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding TertiaryLabelsDisplay}" VerticalAlignment="Center" Margin="15,8"
                                   Foreground="{DynamicResource SecondaryTextBrush}" TextTrimming="CharacterEllipsis"
                                   AutomationProperties.Name="Tertiary Labels Summary"/>
                        <Button Grid.Row="5" Grid.Column="2" Content="Configure..."
                                x:Name="ConfigureTertiaryButton" Click="ConfigureTertiaryButton_Click"
                                AutomationProperties.Name="Configure Tertiary Detection Labels"/>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Screen Capture Tab -->
            <TabItem Header="Capture" AutomationProperties.Name="Screen Capture Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Target Window:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" Margin="15,5"
                                  ItemsSource="{Binding AvailableWindows}"
                                  SelectedItem="{Binding SelectedWindow}"
                                  IsEditable="True"
                                  AutomationProperties.Name="Target Window Selection"
                                  AutomationProperties.HelpText="Select the game window to capture"/>
                        <Button Grid.Row="0" Grid.Column="2" Content="Refresh"
                                Command="{Binding RefreshAvailableWindowsCommand}"
                                AutomationProperties.Name="Refresh Window List"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Method:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Margin="15,5"
                                  SelectedValue="{Binding CaptureMethod}"
                                  SelectedValuePath="Tag"
                                  AutomationProperties.Name="Capture Method">
                            <ComboBoxItem Content="Window" Tag="window"/>
                            <ComboBoxItem Content="Full Screen" Tag="fullscreen"/>
                        </ComboBox>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Monitor:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="15,5"
                                  SelectedIndex="{Binding MonitorIndex}"
                                  AutomationProperties.Name="Monitor Selection">
                            <ComboBoxItem Content="Primary Monitor"/>
                            <ComboBoxItem Content="Monitor 2"/>
                            <ComboBoxItem Content="Monitor 3"/>
                        </ComboBox>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Text-to-Speech Tab -->
            <TabItem Header="Speech" AutomationProperties.Name="Text-to-Speech Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Engine:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" Margin="15,5"
                                  SelectedValue="{Binding TtsEngine}"
                                  SelectedValuePath="Tag"
                                  AutomationProperties.Name="TTS Engine">
                            <ComboBoxItem Content="Windows SAPI" Tag="sapi"/>
                            <ComboBoxItem Content="Piper (Neural)" Tag="piper"/>
                        </ComboBox>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Primary Voice:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="1" Grid.Column="1" Margin="15,5"
                                  ItemsSource="{Binding AvailableVoices}"
                                  SelectedValue="{Binding PrimaryVoice}"
                                  AutomationProperties.Name="Primary Voice Selection"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Primary Speed:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="-10" Maximum="10" Value="{Binding PrimaryRate}"
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Primary Speech Rate"/>
                            <TextBlock Text="{Binding PrimaryRate}" Margin="15,0,0,0" Width="40" VerticalAlignment="Center"/>
                        </StackPanel>

                        <CheckBox Grid.Row="3" Grid.Column="1" Margin="15,5"
                                  Content="Directional Audio"
                                  IsChecked="{Binding PrimaryDirectionalAudio}"
                                  AutomationProperties.Name="Primary Directional Audio"
                                  AutomationProperties.HelpText="Pan audio left/right based on object screen position"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Secondary Voice:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="4" Grid.Column="1" Margin="15,5"
                                  ItemsSource="{Binding AvailableVoices}"
                                  SelectedValue="{Binding SecondaryVoice}"
                                  AutomationProperties.Name="Secondary Voice Selection"/>

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Secondary Speed:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="-10" Maximum="10" Value="{Binding SecondaryRate}"
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Secondary Speech Rate"/>
                            <TextBlock Text="{Binding SecondaryRate}" Margin="15,0,0,0" Width="40" VerticalAlignment="Center"/>
                        </StackPanel>

                        <CheckBox Grid.Row="6" Grid.Column="1" Margin="15,5"
                                  Content="Directional Audio"
                                  IsChecked="{Binding SecondaryDirectionalAudio}"
                                  AutomationProperties.Name="Secondary Directional Audio"
                                  AutomationProperties.HelpText="Pan audio left/right based on object screen position"/>

                        <TextBlock Grid.Row="7" Grid.Column="0" Text="Tertiary Voice:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="7" Grid.Column="1" Margin="15,5"
                                  ItemsSource="{Binding AvailableVoices}"
                                  SelectedValue="{Binding TertiaryVoice}"
                                  AutomationProperties.Name="Tertiary Voice Selection"/>

                        <TextBlock Grid.Row="8" Grid.Column="0" Text="Tertiary Speed:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="8" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="-10" Maximum="10" Value="{Binding TertiaryRate}"
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Tertiary Speech Rate"/>
                            <TextBlock Text="{Binding TertiaryRate}" Margin="15,0,0,0" Width="40" VerticalAlignment="Center"/>
                        </StackPanel>

                        <CheckBox Grid.Row="9" Grid.Column="1" Margin="15,5"
                                  Content="Directional Audio"
                                  IsChecked="{Binding TertiaryDirectionalAudio}"
                                  AutomationProperties.Name="Tertiary Directional Audio"
                                  AutomationProperties.HelpText="Pan audio left/right based on object screen position"/>

                        <TextBlock Grid.Row="10" Grid.Column="0" Text="Volume:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="10" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="0" Maximum="100" Value="{Binding Volume}"
                                    AutomationProperties.Name="Volume"/>
                            <TextBlock Text="{Binding Volume, StringFormat={}{0}%}" Margin="15,0,0,0" Width="50" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Hotkeys Tab -->
            <TabItem Header="Hotkeys" AutomationProperties.Name="Hotkey Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Read Primary:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyReadPrimary}"
                                 AutomationProperties.Name="Read Primary Hotkey"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Read Secondary:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyReadSecondary}"
                                 AutomationProperties.Name="Read Secondary Hotkey"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Read Tertiary:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyReadTertiary}"
                                 AutomationProperties.Name="Read Tertiary Hotkey"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Stop Reading:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyStopReading}"
                                 AutomationProperties.Name="Stop Reading Hotkey"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Toggle Detection:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyToggleDetection}"
                                 AutomationProperties.Name="Toggle Detection Hotkey"/>

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Quit:" VerticalAlignment="Center" Margin="0,8"/>
                        <TextBox Grid.Row="5" Grid.Column="1" Margin="15,5" Text="{Binding HotkeyQuit}"
                                 AutomationProperties.Name="Quit Hotkey"/>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Detection Tab -->
            <TabItem Header="Detection" AutomationProperties.Name="Detection Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Auto-read Cooldown:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="500" Maximum="5000" Value="{Binding AutoReadCooldown}"
                                    TickFrequency="500" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Auto-read Cooldown"/>
                            <TextBlock Text="{Binding AutoReadCooldown, StringFormat={}{0} ms}" Margin="15,0,0,0" Width="70" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Auto-read / Waypoint:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="0.1" Maximum="0.9" Value="{Binding AutoReadConfidenceThreshold}"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Auto-read and Waypoint Confidence Threshold"
                                    AutomationProperties.HelpText="Higher values reduce false positives during automatic reading and waypoint tracking"/>
                            <TextBlock Text="{Binding AutoReadConfidenceThreshold, StringFormat={}{0:F1}}" Margin="15,0,0,0" Width="40" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Manual Read Confidence:" VerticalAlignment="Center" Margin="0,8"/>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="15,5">
                            <Slider Width="180" Minimum="0.1" Maximum="0.9" Value="{Binding ConfidenceThreshold}"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Manual Read Confidence Threshold"
                                    AutomationProperties.HelpText="Lower values allow more detections when manually triggered"/>
                            <TextBlock Text="{Binding ConfidenceThreshold, StringFormat={}{0:F1}}" Margin="15,0,0,0" Width="40" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Crosshair Tab -->
            <TabItem Header="Crosshair" AutomationProperties.Name="Crosshair Settings Tab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Offset X -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Offset X:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="0" Grid.Column="1"
                                Minimum="-100" Maximum="100"
                                Value="{Binding CrosshairOffsetX}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Horizontal Offset"/>
                        <TextBox Grid.Row="0" Grid.Column="2"
                                 Text="{Binding CrosshairOffsetX, UpdateSourceTrigger=PropertyChanged}"
                                 Width="50"
                                 HorizontalAlignment="Right"
                                 AutomationProperties.Name="Crosshair Horizontal Offset Value"/>

                        <!-- Offset Y -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Offset Y:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="1" Grid.Column="1"
                                Minimum="-100" Maximum="100"
                                Value="{Binding CrosshairOffsetY}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Vertical Offset"/>
                        <TextBox Grid.Row="1" Grid.Column="2"
                                 Text="{Binding CrosshairOffsetY, UpdateSourceTrigger=PropertyChanged}"
                                 Width="50"
                                 HorizontalAlignment="Right"
                                 AutomationProperties.Name="Crosshair Vertical Offset Value"/>

                        <!-- Shape -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Shape:" VerticalAlignment="Center" Margin="0,8"/>
                        <ComboBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                                  SelectedValue="{Binding CrosshairShape}"
                                  SelectedValuePath="Tag"
                                  Margin="15,5,0,5"
                                  AutomationProperties.Name="Crosshair Shape">
                            <ComboBoxItem Content="Circle" Tag="Circle"/>
                            <ComboBoxItem Content="Box" Tag="Box"/>
                        </ComboBox>

                        <!-- Size -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Size:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="3" Grid.Column="1"
                                Minimum="50" Maximum="100"
                                Value="{Binding CrosshairSize}"
                                TickFrequency="5"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Size"/>
                        <TextBlock Grid.Row="3" Grid.Column="2"
                                   Text="{Binding CrosshairSize, StringFormat={}{0}px}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Separator -->
                        <Separator Grid.Row="4" Grid.ColumnSpan="3" Margin="0,10"/>

                        <!-- Color Section Header -->
                        <TextBlock Grid.Row="5" Grid.ColumnSpan="3" Text="Crosshair Color" FontWeight="Bold" Margin="0,5,0,10"/>

                        <!-- Color - Red -->
                        <TextBlock Grid.Row="6" Grid.Column="0" Text="Red:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="6" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairColorRed}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Color Red"/>
                        <TextBlock Grid.Row="6" Grid.Column="2"
                                   Text="{Binding CrosshairColorRed, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Color - Green -->
                        <TextBlock Grid.Row="7" Grid.Column="0" Text="Green:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="7" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairColorGreen}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Color Green"/>
                        <TextBlock Grid.Row="7" Grid.Column="2"
                                   Text="{Binding CrosshairColorGreen, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Color - Blue -->
                        <TextBlock Grid.Row="8" Grid.Column="0" Text="Blue:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="8" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairColorBlue}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Color Blue"/>
                        <TextBlock Grid.Row="8" Grid.Column="2"
                                   Text="{Binding CrosshairColorBlue, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Color Preview -->
                        <TextBlock Grid.Row="9" Grid.Column="0" Text="Preview:" VerticalAlignment="Center" Margin="0,8"/>
                        <Rectangle Grid.Row="9" Grid.Column="1" Grid.ColumnSpan="2"
                                   Height="30"
                                   Stroke="White" StrokeThickness="1"
                                   Fill="{Binding CrosshairColor, Converter={StaticResource ColorStringToBrushConverter}}"
                                   Margin="15,5,0,5"
                                   HorizontalAlignment="Stretch"/>

                        <!-- Thickness -->
                        <TextBlock Grid.Row="10" Grid.Column="0" Text="Thickness:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="10" Grid.Column="1"
                                Minimum="1" Maximum="25"
                                Value="{Binding CrosshairThickness}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Thickness"/>
                        <TextBlock Grid.Row="10" Grid.Column="2"
                                   Text="{Binding CrosshairThickness, StringFormat={}{0}px}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Separator -->
                        <Separator Grid.Row="11" Grid.ColumnSpan="3" Margin="0,10"/>

                        <!-- Outline Color Section Header -->
                        <TextBlock Grid.Row="12" Grid.ColumnSpan="3" Text="Outline Color" FontWeight="Bold" Margin="0,5,0,10"/>

                        <!-- Outline Color - Red -->
                        <TextBlock Grid.Row="13" Grid.Column="0" Text="Red:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="13" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairOutlineRed}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Outline Red"/>
                        <TextBlock Grid.Row="13" Grid.Column="2"
                                   Text="{Binding CrosshairOutlineRed, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Outline Color - Green -->
                        <TextBlock Grid.Row="14" Grid.Column="0" Text="Green:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="14" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairOutlineGreen}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Outline Green"/>
                        <TextBlock Grid.Row="14" Grid.Column="2"
                                   Text="{Binding CrosshairOutlineGreen, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Outline Color - Blue -->
                        <TextBlock Grid.Row="15" Grid.Column="0" Text="Blue:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="15" Grid.Column="1"
                                Minimum="0" Maximum="255"
                                Value="{Binding CrosshairOutlineBlue}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Outline Blue"/>
                        <TextBlock Grid.Row="15" Grid.Column="2"
                                   Text="{Binding CrosshairOutlineBlue, StringFormat={}{0:0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>

                        <!-- Outline Color Preview -->
                        <TextBlock Grid.Row="16" Grid.Column="0" Text="Preview:" VerticalAlignment="Center" Margin="0,8"/>
                        <Rectangle Grid.Row="16" Grid.Column="1" Grid.ColumnSpan="2"
                                   Height="30"
                                   Stroke="White" StrokeThickness="1"
                                   Fill="{Binding CrosshairOutlineColor, Converter={StaticResource ColorStringToBrushConverter}}"
                                   Margin="15,5,0,5"
                                   HorizontalAlignment="Stretch"/>

                        <!-- Outline Thickness -->
                        <TextBlock Grid.Row="17" Grid.Column="0" Text="Outline Thickness:" VerticalAlignment="Center" Margin="0,8"/>
                        <Slider Grid.Row="17" Grid.Column="1"
                                Minimum="1" Maximum="25"
                                Value="{Binding CrosshairOutlineThickness}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"
                                Margin="15,5,10,5"
                                AutomationProperties.Name="Crosshair Outline Thickness"/>
                        <TextBlock Grid.Row="17" Grid.Column="2"
                                   Text="{Binding CrosshairOutlineThickness, StringFormat={}{0}px}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"/>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Save"
                    Click="SaveButton_Click"
                    AutomationProperties.Name="Save Settings"/>
            <Button Content="Cancel"
                    Click="CancelButton_Click"
                    AutomationProperties.Name="Cancel"/>
        </StackPanel>
    </Grid>
</Window>
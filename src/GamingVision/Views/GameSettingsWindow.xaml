<Window x:Class="GamingVision.Views.GameSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Game Settings"
        Height="600"
        Width="500"
        MinHeight="500"
        MinWidth="450"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        AutomationProperties.Name="Game Settings Window">

    <Window.Resources>
        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Padding" Value="10"/>
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,5"/>
        </Style>
        <Style x:Key="InputStyle" TargetType="Control">
            <Setter Property="Margin" Value="0,5"/>
            <Setter Property="Padding" Value="5,3"/>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Game Selection -->
        <GroupBox Grid.Row="0" Header="Manage Games" Style="{StaticResource GroupBoxStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <ComboBox Grid.Column="0" ItemsSource="{Binding Games}"
                          SelectedItem="{Binding SelectedGame}"
                          DisplayMemberPath="DisplayName"
                          AutomationProperties.Name="Select Game to Configure"
                          FontSize="14"
                          Padding="8,6"/>
                <Button Grid.Column="1" Content="Add" Width="60" Margin="10,0,5,0"
                        Command="{Binding AddGameCommand}"
                        AutomationProperties.Name="Add New Game"/>
                <Button Grid.Column="2" Content="Delete" Width="60"
                        Command="{Binding DeleteGameCommand}"
                        AutomationProperties.Name="Delete Selected Game"/>
            </Grid>
        </GroupBox>

        <!-- Settings ScrollViewer -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Game Profile Settings -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock>
                            <Run Text="Game Profile ("/>
                            <Run Text="{Binding SelectedGame.DisplayName, FallbackValue=''}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Display Name:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="10,5"
                                 Text="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="Game Display Name"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Model File:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="10,5"
                                 Text="{Binding ModelFile, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="ONNX Model File Path"/>
                        <Button Grid.Row="1" Grid.Column="2" Content="Browse..." Width="75"
                                Command="{Binding BrowseForModelCommand}"
                                AutomationProperties.Name="Browse for Model File"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Window Title:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="10,5"
                                 Text="{Binding WindowTitle, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="Game Window Title"/>
                        <Button Grid.Row="2" Grid.Column="2" Content="Pick..." Width="75"
                                x:Name="PickWindowButton" Click="PickWindowButton_Click"
                                AutomationProperties.Name="Pick Window from Running Applications"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Primary Labels:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Margin="10,5"
                                 Text="{Binding PrimaryLabels, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="Primary Detection Labels"
                                 AutomationProperties.HelpText="Comma-separated list of labels that trigger auto-read"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Secondary Labels:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" Margin="10,5"
                                 Text="{Binding SecondaryLabels, UpdateSourceTrigger=PropertyChanged}"
                                 AutomationProperties.Name="Secondary Detection Labels"
                                 AutomationProperties.HelpText="Comma-separated list of labels read on hotkey only"/>
                    </Grid>
                </GroupBox>

                <!-- Capture Settings -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock>
                            <Run Text="Capture ("/>
                            <Run Text="{Binding SelectedGame.DisplayName, FallbackValue=''}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Method:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <RadioButton Content="Window" IsChecked="{Binding CaptureMethod, Converter={x:Null}}"
                                         GroupName="CaptureMethod" Margin="0,0,20,0"
                                         AutomationProperties.Name="Capture Window"/>
                            <RadioButton Content="Full Screen"
                                         IsChecked="{Binding CaptureMethod, Converter={x:Null}}"
                                         GroupName="CaptureMethod"
                                         AutomationProperties.Name="Capture Full Screen"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Monitor:" Style="{StaticResource LabelStyle}"/>
                        <ComboBox Grid.Row="1" Grid.Column="1" Margin="10,5"
                                  SelectedIndex="{Binding MonitorIndex}"
                                  AutomationProperties.Name="Monitor Selection">
                            <ComboBoxItem Content="Primary Monitor"/>
                            <ComboBoxItem Content="Monitor 2"/>
                            <ComboBoxItem Content="Monitor 3"/>
                        </ComboBox>
                    </Grid>
                </GroupBox>

                <!-- Voice Settings -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock>
                            <Run Text="Voice ("/>
                            <Run Text="{Binding SelectedGame.DisplayName, FallbackValue=''}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Engine:" Style="{StaticResource LabelStyle}"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" Margin="10,5"
                                  SelectedValue="{Binding TtsEngine}"
                                  AutomationProperties.Name="TTS Engine">
                            <ComboBoxItem Content="Windows SAPI" Tag="sapi"/>
                            <ComboBoxItem Content="Piper (Neural)" Tag="piper"/>
                        </ComboBox>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Primary Voice:" Style="{StaticResource LabelStyle}"/>
                        <ComboBox Grid.Row="1" Grid.Column="1" Margin="10,5"
                                  ItemsSource="{Binding AvailableVoices}"
                                  SelectedValue="{Binding PrimaryVoice}"
                                  AutomationProperties.Name="Primary Voice Selection"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Primary Speed:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <Slider Width="150" Minimum="-10" Maximum="10" Value="{Binding PrimaryRate}"
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Primary Speech Rate"/>
                            <TextBlock Text="{Binding PrimaryRate}" Margin="10,0,0,0" Width="30"/>
                        </StackPanel>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Secondary Voice:" Style="{StaticResource LabelStyle}"/>
                        <ComboBox Grid.Row="3" Grid.Column="1" Margin="10,5"
                                  ItemsSource="{Binding AvailableVoices}"
                                  SelectedValue="{Binding SecondaryVoice}"
                                  AutomationProperties.Name="Secondary Voice Selection"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Secondary Speed:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <Slider Width="150" Minimum="-10" Maximum="10" Value="{Binding SecondaryRate}"
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Secondary Speech Rate"/>
                            <TextBlock Text="{Binding SecondaryRate}" Margin="10,0,0,0" Width="30"/>
                        </StackPanel>

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Volume:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <Slider Width="150" Minimum="0" Maximum="100" Value="{Binding Volume}"
                                    AutomationProperties.Name="Volume"/>
                            <TextBlock Text="{Binding Volume, StringFormat={}{0}%}" Margin="10,0,0,0" Width="40"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <!-- Hotkey Settings -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock>
                            <Run Text="Hotkeys ("/>
                            <Run Text="{Binding SelectedGame.DisplayName, FallbackValue=''}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Read Primary:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="10,5" Text="{Binding HotkeyReadPrimary}"
                                 AutomationProperties.Name="Read Primary Hotkey"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Read Secondary:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="10,5" Text="{Binding HotkeyReadSecondary}"
                                 AutomationProperties.Name="Read Secondary Hotkey"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Stop Reading:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="10,5" Text="{Binding HotkeyStopReading}"
                                 AutomationProperties.Name="Stop Reading Hotkey"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Toggle Detection:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Margin="10,5" Text="{Binding HotkeyToggleDetection}"
                                 AutomationProperties.Name="Toggle Detection Hotkey"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Quit:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Margin="10,5" Text="{Binding HotkeyQuit}"
                                 AutomationProperties.Name="Quit Hotkey"/>
                    </Grid>
                </GroupBox>

                <!-- Detection Settings -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock>
                            <Run Text="Detection ("/>
                            <Run Text="{Binding SelectedGame.DisplayName, FallbackValue=''}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Auto-read Cooldown:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <Slider Width="150" Minimum="500" Maximum="5000" Value="{Binding AutoReadCooldown}"
                                    TickFrequency="500" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Auto-read Cooldown"/>
                            <TextBlock Text="{Binding AutoReadCooldown, StringFormat={}{0} ms}" Margin="10,0,0,0" Width="60"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Confidence Threshold:" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                            <Slider Width="150" Minimum="0.1" Maximum="0.9" Value="{Binding ConfidenceThreshold}"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True"
                                    AutomationProperties.Name="Confidence Threshold"/>
                            <TextBlock Text="{Binding ConfidenceThreshold, StringFormat={}{0:F1}}" Margin="10,0,0,0" Width="30"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Save" Width="80" Margin="5" Padding="10,5"
                    Click="SaveButton_Click"
                    AutomationProperties.Name="Save Settings"/>
            <Button Content="Cancel" Width="80" Margin="5" Padding="10,5"
                    Click="CancelButton_Click"
                    AutomationProperties.Name="Cancel"/>
        </StackPanel>
    </Grid>
</Window>

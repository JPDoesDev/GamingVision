<Window x:Class="GamingVision.Overlay.GroupEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Edit Overlay Group"
        Width="550"
        Height="750"
        MinWidth="450"
        MinHeight="650"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Group Name -->
        <GroupBox Header="Group Name" Grid.Row="0">
            <TextBox x:Name="NameTextBox"
                     Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                     MaxLength="50"/>
        </GroupBox>

        <!-- Color and Thickness -->
        <GroupBox Header="Appearance" Grid.Row="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="60"/>
                </Grid.ColumnDefinitions>

                <!-- Color -->
                <TextBlock Text="Color:" VerticalAlignment="Center" Grid.Row="0"/>
                <TextBox x:Name="ColorTextBox"
                         Grid.Row="0" Grid.Column="1"
                         Text="{Binding Color, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="9"
                         Margin="0,0,10,5"/>
                <Rectangle x:Name="ColorPreview"
                           Grid.Row="0" Grid.Column="2"
                           Width="50" Height="30"
                           Stroke="White" StrokeThickness="1"
                           Fill="{Binding Color, Converter={StaticResource ColorStringToBrushConverter}}"
                           Margin="0,0,0,5"/>

                <!-- Thickness -->
                <TextBlock Text="Thickness:" VerticalAlignment="Center" Grid.Row="1"/>
                <Slider x:Name="ThicknessSlider"
                        Grid.Row="1" Grid.Column="1"
                        Minimum="1" Maximum="10"
                        Value="{Binding Thickness}"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="1" Grid.Column="2"
                           Text="{Binding Thickness, StringFormat={}{0}px}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Confidence Threshold -->
                <TextBlock Text="Min Confidence:" VerticalAlignment="Center" Grid.Row="2"/>
                <Slider x:Name="ConfidenceSlider"
                        Grid.Row="2" Grid.Column="1"
                        Minimum="0.05" Maximum="1.0"
                        Value="{Binding ConfidenceThreshold}"
                        TickFrequency="0.05"
                        IsSnapToTickEnabled="True"
                        VerticalAlignment="Center"
                        Margin="0,5,10,5"/>
                <TextBlock Grid.Row="2" Grid.Column="2"
                           Text="{Binding ConfidenceThreshold, StringFormat={}{0:P0}}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>

                <!-- Show Label -->
                <CheckBox x:Name="ShowLabelCheckBox"
                          Grid.Row="3" Grid.ColumnSpan="3"
                          Content="Show label text above box"
                          IsChecked="{Binding ShowLabel}"
                          Margin="0,5,0,0"/>
            </Grid>
        </GroupBox>

        <!-- Box Style -->
        <GroupBox Header="Box Style" Grid.Row="2">
            <StackPanel>
                <RadioButton Content="Solid - Continuous outline"
                             IsChecked="{Binding IsSolid}"
                             Margin="0,0,0,5"/>
                <RadioButton Content="Dashed - Dashed outline"
                             IsChecked="{Binding IsDashed}"
                             Margin="0,0,0,5"/>
                <RadioButton Content="Filled - Semi-transparent fill"
                             IsChecked="{Binding IsFilled}"
                             Margin="0,0,0,5"/>
                <RadioButton Content="High Contrast - White border + colored fill"
                             IsChecked="{Binding IsHighContrast}"
                             Margin="0,0,0,5"/>
                <RadioButton Content="High Contrast Inverted - Black border + colored fill"
                             IsChecked="{Binding IsHighContrastInverted}"/>
            </StackPanel>
        </GroupBox>

        <!-- Preview -->
        <GroupBox Header="Preview" Grid.Row="3" Height="80">
            <Canvas x:Name="PreviewCanvas" Background="#FF1A1A1A"/>
        </GroupBox>

        <!-- Labels Selection -->
        <GroupBox Header="Labels in this Group" Grid.Row="4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Available Labels -->
                <DockPanel Grid.Column="0">
                    <TextBlock Text="Available:" DockPanel.Dock="Top" Margin="0,0,0,5"/>
                    <ListBox x:Name="AvailableLabelsListBox"
                             ItemsSource="{Binding AvailableLabels}"
                             SelectionMode="Extended"/>
                </DockPanel>

                <!-- Add/Remove Buttons -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10">
                    <Button Content="Add &gt;" Click="AddLabel_Click" MinWidth="60" Margin="0,5"/>
                    <Button Content="&lt; Remove" Click="RemoveLabel_Click" MinWidth="60" Margin="0,5"/>
                </StackPanel>

                <!-- Selected Labels -->
                <DockPanel Grid.Column="2">
                    <TextBlock Text="Selected:" DockPanel.Dock="Top" Margin="0,0,0,5"/>
                    <ListBox x:Name="SelectedLabelsListBox"
                             ItemsSource="{Binding SelectedLabels}"
                             SelectionMode="Extended"/>
                </DockPanel>
            </Grid>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="OK" Click="OK_Click" MinWidth="100" IsDefault="True"/>
            <Button Content="Cancel" Click="Cancel_Click" MinWidth="100" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
